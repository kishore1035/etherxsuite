# ============================================================================
# EtherX Excel - Production Backend Environment Variables
# ============================================================================
# This file is a TEMPLATE for production backend deployment
# DO NOT commit this file with actual secrets to version control
# Set these values in your hosting dashboard (Railway, Render, Vercel, etc.)
#
# See ../PRODUCTION_DEPLOYMENT_SETUP.md for detailed deployment instructions

# ============================================================================
# Server Configuration
# ============================================================================

NODE_ENV=production
PORT=5000

# ============================================================================
# CORS Configuration (CRITICAL FOR FRONTEND ACCESS)
# ============================================================================
# Set this to your deployed frontend URL
# Example: https://etherxsuite.vercel.app
# This MUST match your frontend's actual deployment URL

FRONTEND_URL=https://etherxsuite.vercel.app

# Optional: Additional allowed origins (comma-separated)
# Use this if you have multiple frontend deployments (staging, etc.)
ALLOWED_ORIGINS=https://staging.etherxsuite.com,https://preview-etherxsuite.vercel.app

# For development/preview deployments, allow all Vercel/Netlify/Railway URLs
# WARNING: Only use this during development - restrict in production
# CORS_ALLOW_ALL=true

# ============================================================================
# Security Configuration
# ============================================================================
# Generate secure random strings for these:
# Command: openssl rand -base64 32 (on macOS/Linux)
# Or use an online generator: https://www.random.org/

JWT_SECRET=your-super-secret-jwt-key-change-this-in-production-make-it-long-and-random
REFRESH_TOKEN_SECRET=your-super-secret-refresh-key-change-this-in-production-make-it-long
SESSION_SECRET=your-super-secret-session-key-change-this-in-production

JWT_EXPIRES_IN=7d
REFRESH_TOKEN_EXPIRES_IN=30d

# ============================================================================
# Database Configuration
# ============================================================================
# For development, SQLite is fine
# For production, consider PostgreSQL or MySQL for better performance

# SQLite (default, simple):
DATABASE_URL=./data/etherx.db

# PostgreSQL (recommended for production):
# DATABASE_URL=postgresql://username:password@host:5432/etherx
# Example for Railway:
# DATABASE_URL=postgresql://postgres:password@container-host:5432/etherx_prod

# MySQL:
# DATABASE_URL=mysql://username:password@host:3306/etherx

# ============================================================================
# OTP (One-Time Password) Configuration
# ============================================================================

OTP_SERVICE=mock
OTP_EXPIRY_MINUTES=10
OTP_MAX_ATTEMPTS=3

# For production email OTP:
# OTP_SERVICE=sendgrid
# SENDGRID_API_KEY=your-sendgrid-api-key

# For production SMS OTP:
# OTP_SERVICE=twilio
# TWILIO_ACCOUNT_SID=your-twilio-account-sid
# TWILIO_AUTH_TOKEN=your-twilio-auth-token
# TWILIO_PHONE_NUMBER=+1234567890

# ============================================================================
# File Upload Configuration
# ============================================================================

MAX_FILE_SIZE=10485760  # 10MB in bytes

# ============================================================================
# Logging Configuration
# ============================================================================

LOG_LEVEL=info
LOG_FILE=./logs/production.log

# ============================================================================
# Rate Limiting
# ============================================================================
# Requests per time window

RATE_LIMIT_WINDOW=15     # Time window in minutes
RATE_LIMIT_MAX_REQUESTS=100  # Max requests per window

# ============================================================================
# Optional: Third-party Integrations
# ============================================================================

# Google Drive Integration
# GOOGLE_DRIVE_CLIENT_ID=your-client-id
# GOOGLE_DRIVE_CLIENT_SECRET=your-client-secret

# Dropbox Integration
# DROPBOX_CLIENT_ID=your-client-id
# DROPBOX_CLIENT_SECRET=your-client-secret

# SendGrid for Email
# SENDGRID_API_KEY=your-api-key

# Twilio for SMS
# TWILIO_ACCOUNT_SID=your-account-sid
# TWILIO_AUTH_TOKEN=your-auth-token
# TWILIO_PHONE_NUMBER=+1234567890

# ============================================================================
# Deployment Platform Specific Instructions
# ============================================================================
#
# RAILWAY.APP:
#   1. Push code to GitHub
#   2. Go to railway.app, create new project
#   3. Select \"Deploy from GitHub repo\"
#   4. Select your repository
#   5. Go to Variables tab
#   6. Paste all variables from this file
#   7. Backend will start automatically
#
# RENDER.COM:
#   1. Connect GitHub account
#   2. Create new \"Web Service\"
#   3. Select repository and branch
#   4. Set root directory: backend/
#   5. Build command: npm install
#   6. Start command: npm start
#   7. Add Environment Variables in dashboard
#   8. Deploy
#
# VERCEL (for Node.js backend):
#   1. Go to vercel.com
#   2. Import repository
#   3. Set root directory: backend/
#   4. Build: npm install
#   5. Output: (leave empty)
#   6. Install command: npm install
#   7. Start command: npm start
#   8. Add environment variables
#   9. Deploy
#
# HEROKU:
#   1. Create Heroku account and app
#   2. Connect GitHub: heroku git:remote -a your-app-name
#   3. Push code: git push heroku main
#   4. Set vars: heroku config:set VAR=value -a your-app-name
#   5. Monitor: heroku logs --tail -a your-app-name

# ============================================================================
# IMPORTANT PRODUCTION CHECKLIST
# ============================================================================
#
# Before deploying to production:
#
# [ ] NODE_ENV is set to 'production'
# [ ] FRONTEND_URL matches your actual Vercel frontend URL
# [ ] JWT_SECRET is a long random string (not default)
# [ ] REFRESH_TOKEN_SECRET is a long random string (not default)
# [ ] DATABASE backup strategy in place
# [ ] CORS settings allow frontend domain
# [ ] Backend server health check endpoint works
# [ ] WebSocket connections work (test in browser DevTools)
# [ ] IPFS document uploads work
# [ ] Rate limiting is configured
# [ ] Logging is configured
# [ ] Error monitoring is set up (Sentry, etc.)
# [ ] SSL/TLS certificates are valid
# [ ] Backend and frontend are both deployed
#
# After deploying to production:
#
# [ ] Test document save from frontend
# [ ] Check backend logs for errors
# [ ] Test real-time collaboration in multiple windows
# [ ] Verify CORS headers in response
# [ ] Monitor performance metrics
# [ ] Set up alerting for errors and downtime

# ============================================================================
# Testing Backend Connection
# ============================================================================
#
# After deployment, test with curl:
#
# curl https://your-backend-domain/api/health
#
# Should return:
# {\"ok\":true,\"status\":\"ok\",\"pid\":123,\"uptime\":456}
#
# If CORS header is present:
# curl -H \"Origin: https://etherxsuite.vercel.app\" \\
#      -H \"Access-Control-Request-Method: POST\" \\
#      https://your-backend-domain/api/health
#
# Should include: Access-Control-Allow-Origin: https://etherxsuite.vercel.app
